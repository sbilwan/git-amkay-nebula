buildscript {
    repositories {
        jcenter()
        mavenCentral()
    }
    dependencies {
        classpath("com.github.amkay:gradle-gitflow:0.2.0")
    }
}
plugins {
    id 'java'
    id 'maven'
    id "nebula.project" version "3.4.1"
}

apply plugin: 'com.github.amkay.gitflow'

sourceCompatibility = 1.8

repositories {
    mavenCentral()
}

def buildType = version.type.toString().endsWith('RELEASE') ? 'releases' : 'snapshots'
def projVersionType = buildType == 'snapshots' ? 'SNAPSHOT' : 'RELEASE'
println projVersionType


// publishing to nexus using nebula plugin
publishing {
    repositories {
        maven {
            if (version.type.toString().endsWith('RELEASE'))
                url "http://localhost:8081/repository/testamkayreleaseplugin-releases"
            else
                url "http://localhost:8081/repository/testamkayreleaseplugin-snapshots"
            //url "http://localhost:8081/repository/testamkayreleaseplugin-${version.type.toString().endsWith('RELEASE') ? 'releases' : 'snapshots'}"
            credentials {
                username "admin"
                password "admin123"
            }
            publications {
                nebula(MavenPublication) {
                    groupId 'com.telensa.apps'
                    artifactId 'git-amkay-nebula'
                    version "${version}-${projVersionType}"
                }
            }

        }
        mavenLocal()
    }
}

